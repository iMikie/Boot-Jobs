(function(){var t=[].indexOf||function(t){for(var e=0,n=this.length;n>e;e++)if(e in this&&this[e]===t)return e;return-1};define(["backbone","jquery","underscore"],function(e,n,r){var i;return i=function(){function e(t,e,n,r){var i;if(this.filter_display=t,this.filterable_type=e,this.tab=n,this.slug=null!=r?r:void 0,"JobListing"!==(i=this.filterable_type)&&"JobProfile"!==i)throw"Bad argument: "+this.filterable_type;this.filter_data={},this.currently_fetching_ids=!1,this.disable_fetching=!1,this.display_names={"types-full-time":"Full Time","types-contract":"Contract","types-internship":"Internship","types-cofounder":"Cofounder","looking_for-full_time":"Full Time","looking_for-contract":"Contracts","looking_for-internships":"Internships","looking_for-cofounders":"Cofounders","remote-true":"Remote OK","publicly_looking-1":"Actively Looking","publicly_looking-2":"Just Browsing","popular-true":"New and Popular","us_authorized-true":"U.S. Authorized","distributed_team_ok-true":"Will work in a distributed team"}}return e.prototype.disableFetching=function(){return this.disable_fetching=!0},e.prototype.enableFetching=function(){return this.disable_fetching=!1},e.prototype.set_data=function(t){return this.filter_data=t},e.prototype.add_data=function(e,r){return("salary"===e||"equity"===e||"company_size"===e||"last_active"===e||"experience"===e)&&e in this.filter_data&&delete this.filter_data[e],e in this.filter_data?n.isArray(this.filter_data[e])?t.call(this.filter_data[e],r)<0&&this.filter_data[e].push(r):(this.filter_data[e]=[this.filter_data[e]],t.call(this.filter_data[e],r)<0&&this.filter_data[e].push(r)):this.filter_data[e]=r,["roles","locations","publicly_looking","interested_locations","colleges","companies","looking_for","types","keywords","excluded_keywords"].map(function(t){return function(e){return e in t.filter_data&&!n.isArray(t.filter_data[e])?t.filter_data[e]=[t.filter_data[e]]:void 0}}(this)),this.render()},e.prototype.remove_data=function(t,e){var r;if(t in this.filter_data)return n.isArray(this.filter_data[t])?(r=this.filter_data[t].indexOf(e),this.filter_data[t].splice(r,1),0===this.filter_data[t].length&&delete this.filter_data[t]):delete this.filter_data[t],this.render()},e.prototype.render=function(){var t,e,i,o,a,s;this.filter_display.empty(),0===r.keys(this.filter_data).length?this.filter_display.hide():this.filter_display.show(),a=this.filter_data;for(i in a)if(s=a[i],n.isArray(s))for(e=0,o=s.length;o>e;e++)t=s[e],this.renderFilter(i,t);else this.renderFilter(i,s);return n("img.remove-filter",this.filter_display).one("click",function(t){return function(e){return t.remove_data(n(e.target).data("key"),n(e.target).data("value")),!1}}(this)),this.disable_fetching?void 0:this.ids()},e.prototype.renderFilter=function(t,e){var i,o;return i=document.createElement("div"),n(i).addClass("new_taggings tag_edit"),o=document.createElement("img"),n(o).attr("class","remove-filter delete"),n(o).attr("src","/images/tag-field/close-tag.png"),n(o).attr("title","Remove"),n(o).attr("data-key",t),n(o).attr("data-value",e),n(i).html(t+"-"+e in this.display_names?this.display_names[t+"-"+e]:"salary"===t?this.salaryLabel(e.min,e.max):"equity"===t?this.equityLabel(e.min,e.max):"experience"===t?this.experienceLabel(e.min,e.max):"company_size"===t?e+" employees":"last_active"===t?"Active in the last "+e+" days":"interested_locations"===t?"Will move to "+e:"colleges"===t?e:"companies"===t?e:"excluded_keywords"===t?"Exclude: "+r.escape(e):"investing_firm"===t?e.name+" Portfolio":"user_portfolio"===t?"Connected to "+e:"hq"===t?"Score > 50, 5+ total votes":"hq2"===t?"2+ HQ startup YES votes":r.escape(e)),n(i).append(o),this.filter_display.append(i)},e.prototype.ids=function(){var t;return e.trigger("job_filter_fetch_begin",this),this.currently_fetching_ids?void(this.redo_fetch=!0):(t="JobListing"===this.filterable_type?"/job_listings/startup_ids":"/job_profiles/candidate_ids",this.currently_fetching_ids=!0,n.ajax({type:"post",url:t,data:{slug_name:this.slug,tab:this.tab,filter_data:this.filter_data},success:function(t){return function(n){return n.redirect_to_login?(alert("You've been logged out. Please log in again."),void(window.location.href="/login")):t.redo_fetch?(t.redo_fetch=!1,t.currently_fetching_ids=!1,void t.ids()):(t.currently_fetching_ids=!1,e.trigger("job_filter_fetch_complete",n))}}(this)}))},e.prototype.equityLabel=function(t,e){return 2===e&&(e="2+"),t+" &mdash; "+e+"%"},e.prototype.salaryLabel=function(t,e){return 200===e?e="200k+":e+="k","$"+t+"k &mdash; $"+e},e.prototype.experienceLabel=function(t,e){var n;return e=parseInt(e,10),n=11===e?"10+":e,t!==e?t+"&ndash;"+n+" years of experience":n+" years of experience"},e}(),r.extend(i,e.Events),i})}).call(this);