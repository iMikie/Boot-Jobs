(function(){define(["backbone","jquery","underscore","lib/autocomplete"],function(t,e,n,r){var i;return i=function(){function t(t,n,r){this.name=null!=t?t:"",this.keyword_input=n,this.keyword_display=null!=r?r:void 0,this.keywords=[],e(this.keyword_input).keydown(function(t){return function(n){return 13===n.keyCode||9===n.keyCode?(n.stopPropagation(),e(t.keyword_input).focus(),t.addKeyword(e(t.keyword_input).val())):void 0}}(this))}return t.prototype.enableAutocomplete=function(t){return e(this.keyword_input).unbind("keydown"),new r(e(this.keyword_input),{selectCallback:function(t){return function(n){return t.addKeyword(n.item.display_name),e(t.keyword_input).focus()}}(this),queryOptions:{tag_type:t,new_taggable_id:"CompanyTag"===t?void 0:"",new_taggable_type:"CompanyTag"===t?void 0:"",new_taggable_field:"CompanyTag"===t?void 0:""},tags:!0})},t.prototype.addKeyword=function(n){return""!==n?(this.keywords.push(n),e(this.keyword_input).val(""),this.renderKeywords(),t.trigger("keyword_added",{ki_name:this.name,keyword:n})):void 0},t.prototype.removeKeyword=function(e){var n;return n=this.keywords.indexOf(e),this.keywords.splice(n,1),this.renderKeywords(),t.trigger("keyword_removed",{ki_name:this.name,keyword:e})},t.prototype.renderKeywords=function(){var t,n,r,i,o;if(this.keyword_display){for(e(this.keyword_display).html(""),o=this.keywords,t=function(t){return function(n){var r,i;return r=document.createElement("div"),e(r).addClass("new_taggings tag_edit"),i=document.createElement("img"),e(i).attr("class","remove-keyword delete"),e(i).attr("src","/images/tag-field/close-tag.png"),e(i).attr("title","Remove"),e(i).attr("keyword",n),e(r).html(n),e(r).append(i),e(t.keyword_display).append(r)}}(this),n=0,i=o.length;i>n;n++)r=o[n],t(r);return e("img.remove-keyword",e(this.keyword_display)).click(function(t){return function(n){return t.removeKeyword(e(n.target).attr("keyword"))}}(this))}},t}(),n.extend(i,t.Events),i})}).call(this);